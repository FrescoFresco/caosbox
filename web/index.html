<!DOCTYPE html>
<html>
  <head>
    <base href="$FLUTTER_BASE_HREF">
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>CaosBox • beta</title>
    <meta name="theme-color" content="#ffffff" />
    <link rel="manifest" href="manifest.json" />
    <!-- Carga el runtime de Flutter -->
    <script src="flutter.js" defer></script>
    <style>
      html, body { height: 100%; }
      body { margin: 0; background: #ffffff; }
    </style>
  </head>
  <body>
    <noscript>Esta app requiere JavaScript.</noscript>

    <script>
      // Carga clásica compatible (evita el error "FlutterLoader is not defined")
      window.addEventListener('load', function () {
        // Si quedó un Service Worker viejo, lo eliminamos para evitar pantallas en blanco
        if ('serviceWorker' in navigator) {
          navigator.serviceWorker.getRegistrations()
            .then(rs => rs.forEach(r => r.unregister()))
            .catch(() => {});
        }

        // flutter.js define "FlutterLoader"
        const loader = new FlutterLoader();
        loader.loadEntrypoint({
          onEntrypointLoaded: function (engineInitializer) {
            engineInitializer.initializeEngine().then(function (appRunner) {
              appRunner.runApp();
            });
          }
        });
      });
    </script>
  </body>
</html>
